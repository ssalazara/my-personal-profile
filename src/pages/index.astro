---
// Import our new function
import { getSanityClient } from '../lib/sanityClient.ts';

// Define the Sanity config object using Astro's server-side env variables
const sanityConfig = {
  projectId: import.meta.env.PUBLIC_SANITY_PROJECT_ID,
  dataset: import.meta.env.PUBLIC_SANITY_DATASET,
};

// Get the client by passing the config to our function
const client = getSanityClient(sanityConfig);

// The rest of the code is the same!
const query = `*[_type == "project"]{title, description, projectUrl}`;
const projects = await client.fetch(query);


---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>My Personal Profile</title>
    <style>
      body { font-family: system-ui, sans-serif; background: #f0f0f0; color: #333; }
      main { max-width: 800px; margin: auto; padding: 2rem; }
      h1 { color: #111; }
      .project { background: white; padding: 1.5rem; margin-bottom: 1rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
      .project h2 { margin-top: 0; }
      .project a { color: #007bff; text-decoration: none; font-weight: bold; }
    </style>
  </head>
  <body>
    <main>
      <h1>Hello, World!</h1>
      <p>Welcome to my personal profile page. Here are some of my projects:</p>
      
      <div class="projects-list">
        {projects.map(project => (
          <div class="project">
            <h2>{project.title}</h2>
            <p>{project.description}</p>
            {project.projectUrl && <a href={project.projectUrl} target="_blank" rel="noopener noreferrer">View Project &rarr;</a>}
          </div>
        ))}
      </div>
    </main>
  </body>
</html>